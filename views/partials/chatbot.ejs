<!-- Chatbot Widget -->
<% if (user) { %>
<div id="chatbot-widget" class="chatbot-widget">
  <!-- Chat Button -->
  <button id="chatbot-toggle" class="chatbot-toggle" aria-label="Open chat">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
    </svg>
    <span class="chatbot-badge" id="chatbot-badge" style="display: none;">1</span>
  </button>

  <!-- Chat Window -->
  <div id="chatbot-window" class="chatbot-window" style="display: none;">
    <!-- Header -->
    <div class="chatbot-header">
      <div>
        <h3 style="margin: 0; font-size: 1rem;">ðŸ¤– JAMB Study Assistant</h3>
        <p style="margin: 0; font-size: 0.75rem; opacity: 0.8;">Ask me anything about JAMB!</p>
      </div>
      <div style="display: flex; gap: var(--spacing-sm);">
        <button id="chatbot-clear" class="chatbot-icon-btn" aria-label="Clear chat" title="Clear chat history">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          </svg>
        </button>
        <button id="chatbot-minimize" class="chatbot-icon-btn" aria-label="Minimize chat">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
        </button>
      </div>
    </div>

    <!-- Messages Container -->
    <div id="chatbot-messages" class="chatbot-messages">
      <div class="chatbot-message assistant">
        <div class="chatbot-message-content">
          <p>ðŸ‘‹ Hi! I'm your JAMB study assistant. Ask me anything about English, Mathematics, Physics, or Chemistry!</p>
        </div>
      </div>
    </div>

    <!-- Typing Indicator -->
    <div id="chatbot-typing" class="chatbot-typing" style="display: none;">
      <div class="chatbot-message assistant">
        <div class="chatbot-message-content">
          <div class="typing-indicator">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </div>
    </div>

    <!-- Input Area -->
    <div class="chatbot-input-area">
      <textarea 
        id="chatbot-input" 
        class="chatbot-input" 
        placeholder="Type your question..." 
        rows="1"
        maxlength="500"
      ></textarea>
      <button id="chatbot-send" class="chatbot-send-btn" aria-label="Send message">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="22" y1="2" x2="11" y2="13"></line>
          <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
        </svg>
      </button>
    </div>
  </div>
</div>
<% } %>
