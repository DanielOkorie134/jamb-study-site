<!-- Auth Modal -->
<div id="authModal" class="modal-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 2000; align-items: center; justify-content: center; backdrop-filter: blur(5px);">
  <div class="modal-content slide-up" style="background: white; padding: var(--spacing-2xl); border-radius: var(--radius-xl); max-width: 400px; width: 90%; text-align: center; box-shadow: var(--shadow-2xl); position: relative;">
    <button id="closeAuthModal" style="position: absolute; top: var(--spacing-md); right: var(--spacing-md); background: none; border: none; cursor: pointer; color: var(--text-secondary);">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
    </button>
    
    <div style="margin-bottom: var(--spacing-lg); display: inline-flex; align-items: center; justify-content: center; width: 64px; height: 64px; background: var(--primary-ultra-light); border-radius: 50%; color: var(--primary);">
      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line></svg>
    </div>
    
    <h3 style="margin-bottom: var(--spacing-sm); font-size: 1.5rem;">Login Required</h3>
    <p style="color: var(--text-secondary); margin-bottom: var(--spacing-xl);">
      Please login or register to access this subject and track your progress.
    </p>
    
    <div class="flex flex-col gap-md">
      <a href="/login" class="btn btn-primary" style="width: 100%;">Login</a>
      <a href="/register" class="btn btn-outline" style="width: 100%;">Create Account</a>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const authModal = document.getElementById('authModal');
    const closeBtn = document.getElementById('closeAuthModal');
    const protectedLinks = document.querySelectorAll('[data-auth-required="true"]');
    
    // Close modal function
    const closeModal = () => {
      authModal.style.display = 'none';
      document.body.style.overflow = ''; // Restore scrolling
    };
    
    // Open modal function
    const openModal = (e) => {
      e.preventDefault();
      authModal.style.display = 'flex';
      document.body.style.overflow = 'hidden'; // Prevent scrolling
    };
    
    // Attach listeners to protected links
    protectedLinks.forEach(link => {
      link.addEventListener('click', openModal);
    });
    
    // Close on button click
    if (closeBtn) {
      closeBtn.addEventListener('click', closeModal);
    }
    
    // Close on outside click
    if (authModal) {
      authModal.addEventListener('click', (e) => {
        if (e.target === authModal) {
          closeModal();
        }
      });
    }
    
    // Close on Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && authModal.style.display === 'flex') {
        closeModal();
      }
    });
  });
</script>
